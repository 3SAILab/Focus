# 图片上传拖拽排序 - 任务列表

## Phase 1: 基础拖拽功能

- [ ] 1.1 添加拖拽状态管理
  - [ ] 1.1.1 添加 draggedIndex 状态
  - [ ] 1.1.2 添加 dragOverIndex 状态
  - [ ] 1.1.3 添加拖拽事件处理函数

- [ ] 1.2 实现拖拽事件处理
  - [ ] 1.2.1 实现 handleDragStart
  - [ ] 1.2.2 实现 handleDragOver
  - [ ] 1.2.3 实现 handleDrop
  - [ ] 1.2.4 实现 handleDragEnd

- [ ] 1.3 实现文件数组重排序逻辑
  - [ ] 1.3.1 实现数组元素移动函数
  - [ ] 1.3.2 调用 onFilesChange 更新父组件
  - [ ] 1.3.3 测试排序逻辑正确性

## Phase 2: 视觉反馈

- [ ] 2.1 添加拖拽状态样式
  - [ ] 2.1.1 添加 .image-card--dragging 样式
  - [ ] 2.1.2 添加 .image-card--drag-over 样式
  - [ ] 2.1.3 根据状态动态应用样式

- [ ] 2.2 实现插入位置指示
  - [ ] 2.2.1 计算插入位置
  - [ ] 2.2.2 显示插入间隙或指示线
  - [ ] 2.2.3 优化指示器动画

- [ ] 2.3 优化拖拽动画
  - [ ] 2.3.1 使用 transform 实现位置动画
  - [ ] 2.3.2 添加拖拽开始/结束过渡效果
  - [ ] 2.3.3 调整动画时长和缓动函数

## Phase 3: 蒙版图片支持

- [ ] 3.1 实现蒙版检测
  - [ ] 3.1.1 实现文件名检测逻辑
  - [ ] 3.1.2 添加 maskIndices 状态管理
  - [ ] 3.1.3 在文件添加时自动检测蒙版

- [ ] 3.2 添加蒙版视觉标识
  - [ ] 3.2.1 添加蒙版图片边框样式
  - [ ] 3.2.2 添加蒙版图标（可选）
  - [ ] 3.2.3 在拖拽时保持蒙版标识

- [ ] 3.3 蒙版位置提示（可选）
  - [ ] 3.3.1 检测蒙版位置是否符合要求
  - [ ] 3.3.2 显示位置提示信息
  - [ ] 3.3.3 添加手动标记蒙版功能

## Phase 4: 性能优化

- [ ] 4.1 优化渲染性能
  - [ ] 4.1.1 使用 useMemo 缓存预览 URL
  - [ ] 4.1.2 使用 useCallback 缓存事件处理函数
  - [ ] 4.1.3 避免不必要的重渲染

- [ ] 4.2 优化动画性能
  - [ ] 4.2.1 使用 CSS transform 代替 position
  - [ ] 4.2.2 添加 will-change 提示
  - [ ] 4.2.3 在拖拽时禁用过渡动画

## Phase 5: 兼容性和测试

- [ ] 5.1 触摸设备支持（可选）
  - [ ] 5.1.1 添加触摸事件处理
  - [ ] 5.1.2 实现长按触发拖拽
  - [ ] 5.1.3 测试移动设备兼容性

- [ ] 5.2 功能测试
  - [ ] 5.2.1 测试基础拖拽排序
  - [ ] 5.2.2 测试蒙版检测和标识
  - [ ] 5.2.3 测试边界情况

- [ ] 5.3 集成测试
  - [ ] 5.3.1 测试与 PromptBar 的集成
  - [ ] 5.3.2 测试文件上传后的排序
  - [ ] 5.3.3 测试删除文件后的顺序保持

## Phase 6: 文档和优化

- [ ] 6.1 代码文档
  - [ ] 6.1.1 添加函数注释
  - [ ] 6.1.2 添加类型定义注释
  - [ ] 6.1.3 更新组件使用文档

- [ ] 6.2 用户体验优化
  - [ ] 6.2.1 添加首次使用提示（可选）
  - [ ] 6.2.2 优化拖拽手势光标
  - [ ] 6.2.3 添加拖拽音效（可选）
